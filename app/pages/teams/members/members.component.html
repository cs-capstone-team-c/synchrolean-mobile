<!-- Make action bar if the user is the owner of the team show owner buttons-->
<ActionBar class="action-bar">  
    <NavigationButton android.systemIcon="ic_menu_back" (tap)="backToTeams()"></NavigationButton>
    <ActionItem ios.position="left" android:visibility="collapse" (tap)="backToTeams()">
            <Label text="&#xf060;" fontFamily="FontAwesome" fontSize="20"></Label>          
    </ActionItem>
    <Label class="action-bar-title" fontSize="32" text=""></Label>
    <ActionItem *ngIf="isOwner" visibility="{{ teamVisible ?  'visible':'collapse' }}" ios.position="right" text="Edit" android.position="actionBar" (tap)="editTapped()"></ActionItem>
    <ActionItem *ngIf="addMember" visibility="{{ teamVisible ?  'visible':'collapse' }}" ios.position="right" text="Leave" android.position="actionBar" (tap)="leaveTapped()"></ActionItem>
    <!-- <ActionItem visibility="{{ isOwner ?  'visible':'collapse' }}" (tap)="addTapped()" ios.position="left" text="Add" android.position="actionBar"></ActionItem> -->
</ActionBar>
<!-- Make grid layout for the page naming row sizes-->
<Gridlayout class='page' rows="auto, auto, auto, auto, auto, auto, *">
    <!-- Make labels to display name and description of team-->
    <FlexboxLayout class="m-t-4" width="100%" justifyContent='center' row='0'>
        <Label width="100%" class="t-30 text-center" [text]="teamName" textWrap="true" visibility="{{ editTeamNameHit ? 'collapse': 'visible' }}"></Label>
        <TextField #editName returnKeyType="done" (returnPress)="editTeamName(editName.text)" width="100%" class="t-30 text-center"
            [text]="teamName" visibility="{{ editTeamNameHit ?  'visible':'collapse' }}"></TextField>

        <!-- put edit button next to team name that's only visible if team owner and edit button has been hit -->
        <Button width="25%" style="background-color: gray;" alignSelf="flex-end" visibility="{{ editHit ?  'visible':'collapse' }}"
            col="1" class="btn-rounded-sm" (tap)="editTeamName(editName.text)">
            <Span style="color: white;" textAlignment="center" textWrap="true" class='t-16' text="Edit"></Span>
        </Button>
    </FlexboxLayout>

    <FlexboxLayout class="m-t-4" width="100%" justifyContent='center' row='1'>
        <Label width="100%" class="t-20 text-center" [text]="teamDesc" textWrap="true" visibility="{{ editTeamDescHit ? 'collapse': 'visible' }}"></Label>
        <TextField #editDesc returnKeyType="done" (returnPress)="editTeamDesc(editDesc.text)" width="100%" class="t-15 text-center"
            [text]="teamDesc" visibility="{{ editTeamDescHit ?  'visible':'collapse' }}"></TextField>

        <!-- put edit button next to team name that's only visible if team owner and edit button has been hit -->
        <Button width="25%" style="background-color: gray;" alignSelf="flex-end" visibility="{{ editHit ?  'visible':'collapse' }}"
            col="1" class="btn-rounded-sm" (tap)="editTeamDesc(editDesc.text)">
            <Span style="color: white;" textAlignment="center" textWrap="true" class='t-16' text="Edit"></Span>
        </Button>
    </FlexboxLayout>

    <!-- button to add team member by email only visible if team owner and edit hasn't been hit-->
    <Button class="btn btn-primary w-full" *ngIf="!editHit" row="2" visibility="{{ addMember ?  'visible':'collapse' }}" (tap)="addTapped()">
        <FormattedString>
            <Span text="&#xf067; " fontFamily="FontAwesome" fontSize="12"></Span>
            <Span text="Add Members" textWrap="true"></Span>
        </FormattedString>
    </Button>

    <!-- button to delete team visible only if a team owner and edit button hit -->
    <Button class="btn w-full" style="background: tomato;color: whitesmoke" *ngIf="editHit" row="2" visibility="{{ isOwner ?  'visible':'collapse' }}"
        (tap)="deleteTeam()">
        <FormattedString>
            <Span text="&#xf068; " fontFamily="FontAwesome" fontSize="12"></Span>
            <Span text="Delete Team" textWrap="true"></Span>
        </FormattedString>
    </Button>

    <!-- flexbox to contain buttons for differnt lists in page two visible to team members and 4 to team owner -->
    <FlexboxLayout class="m-b-10" justifyContent="center" row='3' orientation="horizontal">
        <!--this button shows up to center the two button config-->
        <!-- <Button width="10%" height="1%" visibility="{{ isOwner ? 'collapse' : 'visible' }}"></Button> -->

        <!-- team members list button visible to owner and members-->
        <Button class="p-y-10 btn-outline btn-grey w-full" textWrap="true" (tap)="teamTapped(false)" text="Team">
            <!-- <Span alignSelf="center" textAlignment="center" class='t-15 m-l-2' text="Team" style="color: whitesmoke;"></Span> -->
        </Button>
        <!-- team metrics members list button visible to owner and members-->
        <Button class="p-y-10 btn-outline btn-grey w-full" (tap)="metricsTapped()" text="Metrics">
            <!-- <Span alignSelf="center" textAlignment="center" class='t-15' style="color: whitesmoke;" text="Metrics"></Span> -->
        </Button>

        <!-- open invites visible to team owners -->
        <Button visibility="{{isOwner ?  'visible':'collapse'}}" class="p-y-10 btn-outline btn-grey w-full" (tap)="invitesTapped()"
            text="Invitations">
            <!-- <Span alignSelf="center" textAlignment="center" style="color: whitesmoke;" textWrap="true" class='t-15' text="Open invites"></Span> -->
        </Button>

        <!-- team permissions visible to team owners -->
        <Button visibility="{{ isOwner ?  'visible':'collapse' }}" class="p-y-10 btn-outline btn-grey w-full" (tap)="permissionsTapped()"
            text="Permissions">
            <!-- <Span alignSelf="center" textAlignment="center" style="color: whitesmoke;" class='t-15' text="Permissions"></Span> -->
        </Button>
    </FlexboxLayout>

    <SearchBar row='4' visibility="{{ teamVisible ?  'visible':'collapse' }}" hint="Member search by last name" [text]="searchPhrase" (submit)="onSubmit($event)" (clear)="onClear($event)"
        textFieldHintColor="#e39e2c"></SearchBar>

    <FlexboxLayout row='5'>
        <ListView [items]="searchMembers">
            <ng-template let-member="item">
                <label [text]="member.firstName + ' ' + member.lastName" class="search-item"></label>
            </ng-template>
        </ListView>
    </FlexboxLayout>

    <!-- Print members in list form visible to members-->
    <FlexboxLayout row='6'>
        <ListView visibility="{{ teamVisible ?  'visible':'collapse' }}" [items]="members">
            <ng-template let-member="item" let-i="index">
                <FlexboxLayout flexWrap='wrap' orientation="horizontal">
                    <!-- Make individual label for members send the id of the tapped item to onTap-->
                    <label width="100%" class="t-30 m-b-2 m-t-8 m-l-10" (tap)="onTap(i)" [text]="member.firstName + ' ' + member.lastName"></label>
                    <Button style="background-color: gray;" width="50%" height="auto" visibility="{{ editHit ?  'visible':'collapse' }}" col="1"
                        class="btn-rounded-sm" (tap)="passOwner(i)">
                        <Span style="color: whitesmoke;" textAlignment="center" textWrap="true" class='t-16' text="Pass Ownership"></Span>
                    </Button>
                    <Button style="background-color: tomato;" width="50%" height="auto" visibility="{{ editHit ?  'visible':'collapse' }}" col="1"
                        class="btn-rounded-sm" (tap)="deleteMember(i)">
                        <Span style="color: whitesmoke;" textAlignment="center" textWrap="true" class='t-16' text="Delete"></Span>
                    </Button>

                    <!-- Personal metrics label -->
                    <GridLayout *ngIf="taskVisible[i]"  rows="auto, auto, *" columns="*,*,*">
                        <Label row="0" col="0" text="Daily" class="m-l-10 t-15" textWrap="true"></Label>
                        <Label row="0" col="1" text="Weekly" class="m-l-10 t-15" textWrap="true"></Label>
                        <Label row="0" col="2" text="Monthly" class="m-l-10 t-15" textWrap="true"></Label>
                        <Label row="1" col="0" [text]="metrics[i][0]" class="m-l-10 t-15" textWrap="true"></Label>
                        <Label row="1" col="1" [text]="metrics[i][1]" class="m-l-10 t-15" textWrap="true"></Label>
                        <Label row="1" col="2" [text]="metrics[i][2]" class="m-l-10 t-15" textWrap="true"></Label>
                    <!-- make list of tasks to display underteam member name -->
                    <ListView row="2" colSpan="3" *ngIf="taskVisible[i]" visibility="{{ isMember ?  'visible':'collapse' }}" width="100%" class="list" [height]="23.75 *getTaskListLength(tasks$[i])"
                        AlignSelf="stretch" [items]="tasks$[i]">
                        <ng-template tkListItemTemplate let-task="item" let-i="index">
                            <label class="m-l-15 t-16" [text]="task.name"></label>
                        </ng-template>
                    </ListView>
                 </GridLayout>
                </FlexboxLayout>
            </ng-template>
        </ListView>
    </FlexboxLayout>
    <!-- Print teams for permissions in list form-->
    <ListView *ngIf="isOwner" visibility="{{ permissionVisible ?  'visible':'collapse' }}" [items]="teams$" row='6' class="list-group">
        <ng-template let-team="item">
            <StackLayout>
                <Label class="t-30 m-b-2 m-l-15" [text]="team.teamName" (tap)="teamPermissionTapped(team)"></Label>
            </StackLayout>
        </ng-template>
    </ListView>

    <!-- print open invites for owner -->
    <ScrollView *ngIf="isOwner" visibility="{{ inviteVisible ?  'visible':'collapse' }}" row='6'>
        <GridLayout rows="*,*,*,*">
            <Label row="0" class="t-30 m-b-2 m-l-15" style="color:black"  text="Your Invites" textWrap="true"></Label>
            <ListView row="1" [items]="invitees" [height]="40*getLength(invitees)" >
                <ng-template let-invitee="item" let-i="index">
                    <Label class="t-25 m-b-2 m-l-25" [text]="invitee.firstName +' '+ invitee.lastName " (tap)="inviteeTapped(i)"></Label>
                </ng-template>
            </ListView>
            <Label row="2" class="t-30 m-b-2 m-l-15" style="color:black" text="Other Invites" textWrap="true" row="2"></Label>
            <ListView row="3" [items]="authInvites" [height]="40*getLength(authInvites)">
                <ng-template let-auth="item" let-j="index">
                    <Label class="t-25 m-b-2 m-l-25" [text]="auth.firstName +' '+ auth.lastName" (tap)="authTapped(j)"></Label>
                </ng-template>
            </ListView>
        </GridLayout>
    </ScrollView>
    <!--team Mertics -->
    <FlexboxLayout row='6' alignItems="center" flexDirection="column" *ngIf="metricsVisible">
        <Label order="0" text="Daily" class="m-t-30 t-20" textWrap="true"></Label>
        <Label order="2" text="Weekly" class="t-20" textWrap="true"></Label>
        <Label order="4" text="Monthly" class="t-20" textWrap="true"></Label>
        <Label order="1" [text]="teamMetrics[0]" class="m-b-30 t-30" textWrap="true"></Label>
        <Label order="3" [text]="teamMetrics[1]" class="m-b-30 t-30" textWrap="true"></Label>
        <Label order="5" [text]="teamMetrics[2]" class="t-30" textWrap="true"></Label>
    </FlexboxLayout>
</Gridlayout>